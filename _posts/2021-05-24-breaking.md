---
published: false
---
## Stop The Optimizing

I had planned to write more posts about some optimizations and whatever other cool stuff I've been working on.

I had planned to make more zink-wip snapshots.

I did shower; stop spamming frog emotes at me.

But I also encountered a bug so bizarre, so infruating, so esoteric, that I need to take a bit of a victory lap now that I've successfully corralled it. So now let's get into a real, vintage SGC blog post like we used to have back when SGC was a good blog.

## The Problem
In the course of writing a suballocator, I ran zero tests, as is my way. When the coding fugue ended, I stumbled weakly to my local CI script and managed to hit the Enter key before collapsing into a restless sleep where I was chased by angry triangles. Things were different when I awoke; namely I now had a lot of failing tests.

But I fixed them, because that's what driver developers do.

All except one, which I assumed was a flake after running it a few times and seeing no failures.

This was how I got to know the horror of `dEQP-GLES3.functional.vertex_array_objects.all_attributes`.

The test itself is awful to debug. It generates `GL_MAX_VERTEX_ATTRIBS` vertex attributes to use with the maximum number of vertex buffers and does a series of draws, verifying the results. Normal enough.

Except the attributes are completely randomized, even whether they're enabled, so no two runs are the same.