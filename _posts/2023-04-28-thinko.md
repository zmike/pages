---
published: false
---
## Shader Objects

Yep, it's all merged. That means if your driver supports [VK_EXT_shader_object](http://vulkan.gpuinfo.org/listdevicescoverage.php?extension=VK_EXT_shader_object&platform=linux), you can finally enjoy Tomb Raider (2013) without any issues.

NVIDIA has just released a new beta driver that I need to test, but I'm hopeful it will no longer crash when trying to use this extension.

## I Didn't Want To Join Your Club Anyway
Remember [that time]({{site.url}}/embarrassments) I mentioned how zink wasn't allowed to use `VK_EXT_vertex_input_dynamic_state` on AMDVLK?

We all got a chuckle, and it was sad/funny, and nobody was surprised, but the funnier part is some code that's been in zink for much longer. [Almost a year, in fact](https://gitlab.freedesktop.org/mesa/mesa/-/commit/c7f46d2ad6de5368cdef09e77bba9f4ff59cad76#2e2fa4b83d660e6375d2148e42efc811e59a3451_1113_1125):

```c
if (screen->info.have_EXT_extended_dynamic_state) {
   if (screen->info.have_EXT_extended_dynamic_state2) {
      if (screen->info.have_EXT_extended_dynamic_state3) {
         if (screen->info.have_EXT_vertex_input_dynamic_state)
            dynamic = ZINK_DYNAMIC_VERTEX_INPUT;
         else
            dynamic = ZINK_DYNAMIC_STATE3;
      } else {
         if (screen->info.have_EXT_vertex_input_dynamic_state)
            dynamic = ZINK_DYNAMIC_VERTEX_INPUT2;
         else
            dynamic = ZINK_DYNAMIC_STATE2;
      }
   } else {
      dynamic = ZINK_DYNAMIC_STATE;
   }
} else {
   dynamic = ZINK_NO_DYNAMIC_STATE;
}
```

This is the conditional for enabling dynamic state usage in zink using an enum. As we can see, the only time `VK_EXT_vertex_input_dynamic_state` is enabled is if either `VK_EXT_extended_dynamic_state2` or `VK_EXT_extended_dynamic_state3` are also enabled. This cuts down on the number of codepaths that can be used on drivers, which improves performance and debuggability.

AMD's drivers don't yet support `VK_EXT_extended_dynamic_state3`, as anyone can see from gpuinfo. They do, however, support `VK_EXT_extended_dynamic_state2`, so the driver-side disablement of `VK_EXT_vertex_input_dynamic_state` does have some effect.

Not.

Way, way back, just over a year ago, I was doing some testing on AMD drivers. One thing I noticed was that trying to run any of the GLES CTS caselists on these drivers caused GPU hangs, so I stopped running those, leaving me with just GL4.6 CTS.

And what happened when I enabled `VK_EXT_extended_dynamic_state2` there, you ask? Test failures. Lots of test failures.

Thus, AMD got the cone of shame: [a driver workaround to explicitly disable this extension](https://gitlab.freedesktop.org/mesa/mesa/-/commit/c7122814c5d2a9a547a2300bcd861415b82690d3).

In conclusion, we all had a good chuckle about AMD blocking zink from using `VK_EXT_vertex_input_dynamic_state`, but...

Well, there's nothing to this story that we didn't already expect.

